<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>McQueen Race Player</title>
    <link href="https://fonts.googleapis.com/css2?family=Racing+Sans+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --red: #D32F2F;
            --dark-red: #8f1212;
            --yellow: #FFD600;
            --black: #1a1a1a;
            --white: #f5f5f5;
        }

        body {
            background-color: #222;
            font-family: 'Racing Sans One', cursive;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--white);
            /* ≈†achovnicov√© pozad√≠ */
            background-image: 
                linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), 
                linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            overflow: hidden; /* Zabr√°n√≠ scrollov√°n√≠ na mobilu */
        }

        .dashboard {
            background: linear-gradient(180deg, var(--red) 0%, var(--dark-red) 100%);
            width: 90%;
            max-width: 400px; /* Maxim√°ln√≠ ≈°√≠≈ôka pro PC */
            border-radius: 25px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.9), inset 0 2px 10px rgba(255,255,255,0.4);
            text-align: center;
            border: 5px solid var(--yellow);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* N√°lepka 95 */
        .sticker-95 {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 30px;
            color: var(--yellow);
            text-shadow: 3px 3px 0 #c62828;
            transform: skew(-15deg);
            z-index: 10;
        }

        /* Obr√°zek Bleska nad p≈ôehr√°vaƒçem */
        .mcqueen-img {
            width: 120px;
            height: auto;
            margin-top: -70px; /* Aby "vyj√≠≈ædƒõl" z kapoty */
            margin-bottom: 10px;
            filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5));
            transition: transform 0.3s;
            z-index: 20;
        }
        
        .dashboard:hover .mcqueen-img {
            transform: scale(1.1) rotate(-5deg);
        }

        .status-display {
            background: rgba(0, 0, 0, 0.4);
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 14px;
            color: var(--yellow);
            margin-bottom: 15px;
            letter-spacing: 1px;
        }

        #album-art {
            width: 100%;
            max-width: 280px; /* Aby nebyl ob≈ô√≠ na tabletu */
            aspect-ratio: 1/1;
            border-radius: 15px;
            border: 4px solid var(--black);
            box-shadow: 0 10px 25px rgba(0,0,0,0.6);
            margin-bottom: 15px;
            object-fit: cover;
            background-color: #000;
        }

        .track-info {
            width: 100%;
            margin-bottom: 20px;
        }

        h2 {
            margin: 5px 0;
            font-size: 1.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-shadow: 2px 2px 0 #000;
        }

        p {
            margin: 0;
            color: var(--yellow);
            font-size: 1rem;
            text-transform: uppercase;
        }

        /* Startovac√≠ tlaƒç√≠tko */
        #btn-start-engine {
            width: 100%;
            padding: 15px;
            background: var(--yellow);
            color: var(--black);
            border: none;
            border-radius: 50px;
            font-family: inherit;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 6px 0 #F57F17, 0 10px 20px rgba(0,0,0,0.4);
            margin-bottom: 10px;
            text-transform: uppercase;
            animation: bounce 2s infinite;
        }

        #btn-start-engine:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #F57F17;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* Ovl√°dac√≠ panel */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 280px;
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 50px;
            box-sizing: border-box; 
        }

        button.control-btn {
            background: var(--white);
            border: none;
            color: var(--black);
            font-family: inherit;
            cursor: pointer;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 0 #999;
            transition: all 0.1s;
        }

        button.control-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #999;
        }

        #btn-toggle {
            width: 70px;
            height: 70px;
            font-size: 32px;
            background: var(--yellow);
            box-shadow: 0 5px 0 #F57F17;
        }
        
        #btn-toggle:active {
            box-shadow: 0 0 0 #F57F17;
        }

        /* Pro velmi mal√© telefony */
        @media (max-height: 700px) {
            .dashboard { padding: 15px; }
            #album-art { max-width: 200px; }
            .mcqueen-img { width: 90px; margin-top: -50px; }
        }
    </style>
</head>
<body>

    <div class="dashboard" id="player-container">
        <img src="blesk.jpg" alt="Blesk McQueen" class="mcqueen-img">
        
        <div class="sticker-95">95</div>
        
        <div class="status-display" id="status-text">Zah≈ô√≠v√°m pneumatiky...</div>
        
        <button id="btn-start-engine">
            NASTARTOVAT MOTOR ‚ö°
        </button>

        <img id="album-art" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Simple_Music.svg/600px-Simple_Music.svg.png" alt="Album Art">
        
        <div class="track-info">
            <h2 id="track-name">ƒåek√°m na z√°vod</h2>
            <p id="artist-name">Spotify Player</p>
        </div>

        <div class="controls">
            <button class="control-btn" id="btn-prev">‚èÆ</button>
            <button class="control-btn" id="btn-toggle">‚ñ∂</button>
            <button class="control-btn" id="btn-next">‚è≠</button>
        </div>
    </div>

    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    <script>
        // ==========================================
        //  ZDE VLO≈Ω SV≈ÆJ NOV√ù TOKEN (z konzole)
        // ==========================================
        const token = 'BQBXCmc51f8_rEaZXRnC-UVhJxe39MhR7ywarH2Z_yK8OF_Hl9HMXly8O4b0do0gEGGRhWxIcOgqdO5LSWozLkPnUpXPTVU2KpRpG0K9691QapvTFxDsML9omEmrHbYGcjo7sHY0izGwdPOjnjD9VGfK8jStGAclJly67Fsu4UtAgybOSaM-flTqAO3PAU37qWDq3gatniI2axG4diEnr9W7cjS51esAdE_IiWb1hofcJxEK7eOnth8BLwt_7z9-7vWKbYe-W2x1'; 
        // ==========================================

        const playlistURI = 'spotify:playlist:6mymeu4hMJDaBrqYHBwqb6'; // Tv≈Øj Hip-Hop Playlist

        window.onSpotifyWebPlaybackSDKReady = () => {
            const player = new Spotify.Player({
                name: 'McQueen Mobile Player',
                getOAuthToken: cb => { cb(token); },
                volume: 0.8
            });

            // Funkce pro start playlistu
           // Vylep≈°en√° funkce pro start (Vypne shuffle + start od 1. p√≠sniƒçky)
            const nastartujPlaylist = (device_id) => {
                const apiHeader = {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                };

                // KROK 1: Vypnout Shuffle (n√°hodn√© p≈ôehr√°v√°n√≠)
                fetch(`https://api.spotify.com/v1/me/player/shuffle?state=false&device_id=${device_id}`, {
                    method: 'PUT',
                    headers: apiHeader
                })
                .then(() => {
                    // KROK 2: Pustit playlist od zaƒç√°tku
                    console.log('Shuffle vypnuto. Startuji playlist...');
                    
                    return fetch(`https://api.spotify.com/v1/me/player/play?device_id=${device_id}`, {
                        method: 'PUT',
                        body: JSON.stringify({ 
                            context_uri: playlistURI,
                            offset: { position: 0 } // <--- TOTO ZAJIST√ç START OD PRVN√ç SKLADBY
                        }),
                        headers: apiHeader
                    });
                })
                .then((res) => {
                    if(res.ok) {
                        console.log('Motor nahozen! Jedu od zaƒç√°tku.');
                        document.getElementById('status-text').innerText = "Jedu na pln√Ω plyn! ‚ö°";
                    } else {
                        console.error("Chyba startu:", res);
                    }
                });
            };

            // Listenery
            player.addListener('ready', ({ device_id }) => {
                console.log('Ready with Device ID', device_id);
                document.getElementById('status-text').innerText = "üèÅ P≈ôipraveno! üèÅ";

                // Aktivace tlaƒç√≠tka Start
                const startBtn = document.getElementById('btn-start-engine');
                startBtn.onclick = () => {
                    nastartujPlaylist(device_id);
                    // Efekt kliknut√≠ - skryje tlaƒç√≠tko po chv√≠li
                    startBtn.innerText = "T√öROV√ÅN√ç MOTORU...";
                    setTimeout(() => {
                        startBtn.style.display = 'none'; // Schov√° tlaƒç√≠tko
                    }, 2000);
                };
            });

            player.addListener('player_state_changed', state => {
                if (!state) return;
                const track = state.track_window.current_track;
                const isPaused = state.paused;

                // Update text≈Ø
                document.getElementById('track-name').innerText = track.name;
                document.getElementById('artist-name').innerText = track.artists[0].name;
                document.getElementById('album-art').src = track.album.images[0].url;
                
                // Update Play/Pause ikony
                document.getElementById('btn-toggle').innerText = isPaused ? '‚ñ∂' : '‚è∏';

                // Pokud hraje hudba, tlaƒç√≠tko Start zmiz√≠ (pokud tam je≈°tƒõ bylo)
                if (!isPaused) {
                     document.getElementById('btn-start-engine').style.display = 'none';
                }
            });

            // Chyby
            player.addListener('authentication_error', ({ message }) => {
                document.getElementById('status-text').innerText = "‚ö† Do≈°el benz√≠n (Token vypr≈°el)";
                console.error(message);
            });

            player.connect();

            // Tlaƒç√≠tka
            document.getElementById('btn-toggle').onclick = () => player.togglePlay();
            document.getElementById('btn-prev').onclick = () => player.previousTrack();
            document.getElementById('btn-next').onclick = () => player.nextTrack();
        };
    </script>
</body>
</html>
